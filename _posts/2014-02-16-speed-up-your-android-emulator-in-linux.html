---
layout: post
title: Speed-up your Android Emulator in Linux
date: '2014-02-16T04:58:00.000-08:00'
author: Chandra Sekhar Nayak
tags:
- HAXM
- GPU Hosting
- Kernel-based virtual system
- KVM
- Android
- Tips & Tricks
- Emulator
- Hardware Acceleration
modified_time: '2014-08-16T21:06:43.758-07:00'
thumbnail: http://2.bp.blogspot.com/-gzs_5xwQK4Q/UwBbABT4LrI/AAAAAAAACIs/S1VjIDAho0c/s72-c/Screenshot+from+2014-02-16+11:59:09.png
blogger_id: tag:blogger.com,1999:blog-5265809569150335007.post-4734035111146525413
blogger_orig_url: http://www.chansek.com/2014/02/speed-up-your-android-emulator-in-linux.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; As Android ecosystem becomes the Largest Mobile Platform, many developers want to put their legs in this ecosystem. Android ecosystem gives its users a large variety of devices powered with different specs. This become headache for almost all Android developers in testing their application while developing and make sure that it will work proper in wide range of devices. So to do this, developers create different emulators with different specs and run their app. But are they happy with it? &nbsp;I guess, No. Because the performance of Android Emulator is very slow, and if the application is doing some major works like server communication, animations, etc, then emulator sucks like anything.<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This post focuses on speeding up your Android Emulator, so that it will run as fast as the real device.<br /><br /><h3 style="text-align: left;">This Post Is For</h3><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Are you an Android Developer?<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Are you developing your applications in Linux platform?<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Is your emulator performance is very slow?<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Those who has the answer <b>Yes </b>for all the above questions can get a solution from this post.</div><div><br /></div><h3 style="text-align: left;">How To Achieve This?</h3><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; To achieve this you just need to configure your Emulator with some specific Android System Images and Hardware Drivers and let it take the advantage of Hardware Acceleration.</div><div><br /></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; You can make your Emulator take the advantage of Hardware Acceleration in the following ways:</div><div><ul style="text-align: left;"><li>By configuring it with Graphics Acceleration</li><li>By configuring it with Virtual Machine Acceleration</li></ul><h3 style="text-align: left;"></h3><h3 style="text-align: left;">Configuring Emulator With Graphics Acceleration:</h3></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Graphics Accelerated Emulators wil take the advantage of the systems's G<span style="background-color: #f9f9f9; color: #222222; font-family: Roboto, sans-serif; font-size: 14px; line-height: 19px;">raphics Processing Unit (GPU) to make the Emulator run faster and more responsive.</span><br /><span style="background-color: #f9f9f9; color: #222222; font-family: Roboto, sans-serif; font-size: 14px; line-height: 19px;"><br /></span><span style="background-color: #f9f9f9; color: #222222; font-family: Roboto, sans-serif; font-size: 14px; line-height: 19px;"><b>NOTE: </b>This will only work if your PC has GPU. Otherwise instead of increasing the performance, it may decrease it.</span></div><h4 style="text-align: left;"><span style="background-color: #f9f9f9; color: #222222; font-family: Roboto, sans-serif; font-size: 14px; line-height: 19px;">Prerequisites:</span></h4><div style="text-align: left;"><span style="background-color: #f9f9f9; color: #222222; font-family: Roboto, sans-serif; font-size: 14px; line-height: 19px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; You need to install the following two things through Android SDK Manager:</span><span style="background-color: #f9f9f9; color: #222222; font-family: Roboto, sans-serif; font-size: 14px; line-height: 19px;">&nbsp;</span></div><div style="text-align: left;"></div><ul style="text-align: left;"><li>Android SDK Tools, Revision 17 or higher</li><li>Android SDK Platform API 15, Revision 3 or higher (Android 4.0.3 or higher)</li></ul><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Are you running your emulator through command line? Type the following command to start an emulator:</div><div><br /></div><textarea cols="70" name="code" rows="1" wrap="off">    emulator -avd &lt;avd_name&gt; -gpu on</textarea><br /><div>&lt;avd_name&gt; <br /><b>NOTE: </b>The &lt;avd_name&gt; should be the name of any AVD which has the <b>Target </b>more than <b>Android 4.0.3</b>.<br /><b><br /></b><b>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </b>Are you running emulator through eclipse? Follow the below steps:<br /><br /><ol style="text-align: left;"><li>Right click on your project folder, Go to <b>Run As &gt; Run Configurations...</b></li><li>Click on <b>Android Application &gt; New_configuration.</b></li><li>Click the <b>Target </b>tab.</li><li>Select an AVD with <b>Android 4.0.3 </b>or higher.</li><li>In the <b>Additional Emulator Command Line Options </b>field, enter: -<b>gpu&nbsp;on</b></li><li>Run your application using this Run Configuration.</li></ol><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Instead of setting the Run Configuration each time you run your application, if you want to configure it once and use it for all time, then follow the below steps:</div></div><div><ol style="text-align: left;"><li>Create a new AVD with T<b>arget</b>&nbsp;as <b>Android 4.0.3 </b>or higher.</li><li>In the Hardware selection, click <b>New </b>and select the option <b>GPU emulation </b>and set the value to <b>yes</b>.</li><li>Click <b>Create AVD</b>. And you are done.</li></ol><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Now you can use this AVD to run your application any number of time. Below is the sample screenshot of this:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-gzs_5xwQK4Q/UwBbABT4LrI/AAAAAAAACIs/S1VjIDAho0c/s1600/Screenshot+from+2014-02-16+11:59:09.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-gzs_5xwQK4Q/UwBbABT4LrI/AAAAAAAACIs/S1VjIDAho0c/s1600/Screenshot+from+2014-02-16+11:59:09.png" height="320" width="211" /></a></div><br /><h3 style="text-align: left;">Configuring Emulator With Virtual Machine Acceleration:</h3></div></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Before doing anything you should first know whether your PC supports any of the following virtualization technologies or not.</div><div><ol style="text-align: left;"><li>Intel Virtualization Technology (VT, VT-x, vmx)&nbsp;extensions.</li><li>AMD Virtualization (AMD-V, SVM) extensions.</li></ol><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; To know whether your PC supports any of the above virtualization technologies, use the following command in the terminal:</div><div><br /></div><textarea cols="70" name="code" rows="1" wrap="off">    egrep -c '(vmx|svm)' /proc/cpuinfo</textarea><br /><div><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The output of the following command will be an integer value. If the value is:<br /><br /><ul style="text-align: left;"><li><b>0 </b>- Means your PC does not supports hardware virtualization. So you cannot use <b>VM Acceleration </b>for your emulator. You have to be satisfied with <b>GPU Emulation </b>explained above.</li><li><b>1 </b>or more - Yes, your PC supports hardware virtualization. So you can proceed with the below steps.</li></ul><h4 style="text-align: left;"><span style="background-color: #f9f9f9; color: #222222; font-family: Roboto, sans-serif; font-size: 14px; line-height: 19px;">Prerequisites:</span></h4><div><div><span style="background-color: #f9f9f9; color: #222222; font-family: Roboto, sans-serif; font-size: 14px; line-height: 19px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; You got confirmed that your PC supports hardware virtualization. so before proceeding further install the following two things through Android SDK Manager:</span><span style="background-color: #f9f9f9; color: #222222; font-family: Roboto, sans-serif; font-size: 14px; line-height: 19px;">&nbsp;</span></div><div></div><ul><li>Android SDK Tools, Revision 17 or higher</li><li>Android x-86 based System Image</li><li>Create an AVD with the above two things.</li></ul><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Linux based OS supports hardware virtualization through a software package called&nbsp;<a href="http://en.wikipedia.org/wiki/Kernel-based_Virtual_Machine" target="_blank">Kernel-based Virtual Machine</a>&nbsp;(KVM). So your next step is to install KVM on your PC.</div></div></div></div><div><br /></div><h3 style="text-align: left;">Installing Kernel-based Virtual Machine (KVM):</h3><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Open your <b>Terminal </b>and execute<br /><br /></div><div><textarea cols="70" name="code" rows="1" wrap="off">    kvm-ok</textarea></div><div><b><br /></b><b>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </b>You might get any of the following results:<br /><br /><textarea cols="70" name="code" rows="1" wrap="off">    INFO: /dev/kvm exists     KVM acceleration can be used</textarea><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Congrats, your PC is ready to use hardware virualization. you just need to install KVM and use it.<br /><br /></div></div><textarea cols="70" name="code" rows="1" wrap="off">    INFO: KVM is disabled by your BIOS     KVM acceleration can NOT be used</textarea><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; You just <b>Shut Down </b>your PC and next time when you starts, just go to <b>BIOS Setup </b>&nbsp;and enable the virtualization. After enabling it you can go forward to install KVM and use it. The following screenshot may help you a bit on enabling the virtualization in BIOS.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-0nFRA4WmaJk/UwBuW-W50WI/AAAAAAAACI8/IpA4OTeFOIE/s1600/haxm07.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-0nFRA4WmaJk/UwBuW-W50WI/AAAAAAAACI8/IpA4OTeFOIE/s1600/haxm07.jpg" height="198" width="320" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Now start installing the KVM package using the following command in terminal:</div><div class="separator" style="clear: both; text-align: left;"><br /></div><textarea cols="80" name="code" rows="1" wrap="off">    sudo apt-get install qemu-kvm libvirt-bin ubuntu-vm-builder bridge-utils</textarea><br /><div class="separator" style="clear: both; text-align: left;"><br /></div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; After the installation successfully completes, add your user name to the following groups:<br /><br /><textarea cols="70" name="code" rows="1" wrap="off">    sudo adduser `id -un` libvirtd     sudo adduser `id -un` kvm</textarea><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; You are almost done. Now you just need to restart your PC to make these changes be affected. But before going to any further steps lets verify whether your installation was successful or not.<br /><br /><h3 style="text-align: left;">Verifying KVM Installation:</h3><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; In the terminal, execute:<br /><br /><textarea cols="70" name="code" rows="1" wrap="off">    virsh -c qemu:///system list</textarea><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Are you getting an output like below? Then your installation was right.<br /><br /><textarea cols="70" name="code" rows="1" wrap="off">    Id Name                 State     ----------------------------------</textarea><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; You may also get an output something like this, then something is wrong. You need to fix this before you move on.<br /><br /><textarea cols="70" name="code" rows="1" wrap="off">    libvir: Remote error : Permission denied     error: failed to connect to the hypervisor</textarea><br /><br /><h3 style="text-align: left;">Almost Done:</h3></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; After installation of KVM succeed, you just need to make it used by Emulator. So lets do that.</div><div><ol style="text-align: left;"><li>If you are running the emulator through command line, then execute the command as below:<br /><br /><textarea cols="70" name="code" rows="1" wrap="off">    emulator -avd &lt;avd_name&gt; -qemu -m 512 -enable-kvm</textarea></li><li>If you are running the emulator using eclipse, then follow the below steps:<br /> </li><ol><li>Right click on your project folder, then go to <b>RunAs &gt; Run Configurations...</b></li><li>On the <b>Run Configurations, </b>select your project configuration or create a new configuration.</li><li>Click the <b>Target </b>tab.</li><li>Select an AVD associated with any x-86 based system image.</li><li>In the <b>Additional Emulator Command Line Options </b>field, type:<br /><br /><textarea cols="50" name="code" rows="1" wrap="off">    -qemu -m 512 -enable-kvm</textarea></li></ol></ol><h3 style="text-align: left;">References:</h3><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<a href="http://software.intel.com/en-us/android/articles/speeding-up-the-android-emulator-on-intel-architecture" target="_blank">Speeding-up Android Emulator in Intel PCs</a></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<a href="https://help.ubuntu.com/community/KVM/Installation" target="_blank">Installing KVM</a></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<a href="http://developer.android.com/tools/devices/emulator.html" target="_blank">Using Android Emulator</a></div><h3 style="text-align: left;">Conclusion:</h3></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; After following the above mentioned step, your Emulator will run faster like Usain Bolt and more responsive.The only thing is, you just need to configure the install the KVM properly and the AVD configurations should be proper as per the instructions.</div></div>