---
layout: post
title: Merge Multiple Images into One Image in Android
date: '2012-06-08T22:08:00.000-07:00'
author: Chandra Sekhar Nayak
tags:
- Bitmap
- Image Processing
- Android
modified_time: '2014-08-17T02:03:05.124-07:00'
thumbnail: http://4.bp.blogspot.com/-ppv6-j1pc6I/T9LSEWj2k-I/AAAAAAAAATA/GEatCyrPSrQ/s72-c/Source+images.png
blogger_id: tag:blogger.com,1999:blog-5265809569150335007.post-5426356514221158254
blogger_orig_url: http://www.chansek.com/2012/06/merge-multiple-images-into-one-image-in.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><h2 style="text-align: left;"><span style="font-size: large;">Introduction:&nbsp;</span></h2><div><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="font-family: Arial, Helvetica, sans-serif;">This blog post is completely related to my previous post&nbsp;<a href="http://androidattop.blogspot.in/2012/05/splitting-image-into-smaller-chunks-in.html"><b>Splitting an image into smaller chunks</b></a>. As far as the work is concerned both are responsible for completely opposite work. First one is responsible for splitting and this one is responsible for merging.</span><br /><br /></div><h3 style="text-align: left;">                         <span style="font-size: large;">Where We Need This?</span></h3><div><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;As I said in my&nbsp;<a href="http://androidattop.blogspot.in/2012/05/splitting-image-into-smaller-chunks-in.html">previous post</a>&nbsp;this kind of splitting and merging concept is very much essential for sending and receiving larger image files across the web.</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;My&nbsp;<a href="http://androidattop.blogspot.in/2012/05/splitting-image-into-smaller-chunks-in.html">previous post</a>&nbsp;will help you to send larger image files and this post will help you to merge the received image chunks to get the original one.<br /><br /></div><h3 style="text-align: left;">                         <span style="font-size: large;">How To Achieve This?</span></h3><div><span style="font-size: large;"><br /></span></div><div>We simply need to follow the following steps to achieve this.<br /><ol style="text-align: left;"><li>Get all the smaller image chunks.</li><li>Find the width and height of those smaller images. (NOTE: all image chunks are of same size)</li><li>Create a Bitmap with <b>width = width_of_each_smaller_chunk * rows</b> and <b>height = height_of_each_smaller_chunk&nbsp;* columns</b>.</li><li>Create a Canvas encapsulating the Bitmap object in it.</li><li>Now draw the smaller chunks on the Canvas object.</li></ol></div><div><h3 style="text-align: left;">                        <span style="font-size: large;">Source Code:</span></h3></div><div><span style="font-size: large;"><br /></span></div><div>The below code snippet shows how to merge smaller image chunks into one.<br /><br /></div></div><br /><pre class="brush:java;">package com.example.android.imagemerger;<br /><br />import java.util.ArrayList;<br /><br />import android.app.Activity;<br />import android.content.Intent;<br />import android.graphics.Bitmap;<br />import android.graphics.Canvas;<br />import android.graphics.drawable.BitmapDrawable;<br />import android.os.Bundle;<br />import android.view.View;<br />import android.view.View.OnClickListener;<br />import android.widget.Button;<br />import android.widget.EditText;<br />import android.widget.GridView;<br />import android.widget.ImageView;<br /><br />/**<br /> * @author Chandra Sekhar Nayak<br /> * @version 1.0 <br /> * <br /> * This class is an activity and will displayed first when<br /> * application starts This Activity will display small images in a grid<br /> * view It also shows a button showing "Merge" on it. When clicks<br /> * merges the small image chunks<br /> */<br />public class SmallImagesActivity extends Activity implements OnClickListener {<br /><br />    ArrayList&lt;Bitmap&gt; smallImages;<br /><br />    /** Called when the activity is first created. */<br />    @Override<br />    public void onCreate(Bundle savedInstanceState) {<br />        super.onCreate(savedInstanceState);<br />        setContentView(R.layout.image_grid);<br /><br />        // This application will for merging number of smaller chunks to make<br />        // the original So for that we need some smaller image chunks. As I<br />        // don't have any smaller images, so I programmatically first split an<br />        // image to get the smaller image chunks and then merge them to get the<br />        // original one. If you want you can also get some smaller chunks and<br />        // directly merge them. The below 4 lines of code does the splitting<br />        // operation<br />        ImageView image = new ImageView(getApplicationContext());<br />        image.setImageResource(R.drawable.katewinslet);<br />        int chunkNumbers = 25;<br />        smallImages = splitImage(image, chunkNumbers);<br /><br />        // This code is to show all the smaller image chunks into a grid<br />        // structure<br />        GridView grid = (GridView) findViewById(R.id.gridview);<br />        grid.setAdapter(new ImageAdapter(this, smallImages));<br />        grid.setNumColumns(5);<br /><br />        // This gets the merge button and registers an click listener on it.<br />        Button mergeButton = (Button) findViewById(R.id.merge_button);<br />        mergeButton.setOnClickListener(this);<br />    }<br /><br />    /**<br />     * Splits the source image and show them all into a grid in a new activity<br />     * <br />     * @param image The source image to split<br />     * @param chunkNumbers The target number of small image chunks to be formed<br />     *            from the source image<br />     * @return ArrayList&lt;Bitmap&gt; The resulted smaller image chunks in a List of<br />     *         Bitmaps<br />     */<br />    private ArrayList&lt;Bitmap&gt; splitImage(ImageView image, int chunkNumbers) {<br /><br />        // For the number of rows and columns of the grid to be displayed<br />        int rows, cols;<br />        rows = cols = 5;<br /><br />        // For height and width of the small image chunks<br />        int chunkHeight, chunkWidth;<br /><br />        // To store all the small image chunks in bitmap format in this list<br />        ArrayList&lt;Bitmap&gt; chunkedImages = new ArrayList&lt;Bitmap&gt;(chunkNumbers);<br /><br />        // Getting the scaled bitmap of the source image<br />        BitmapDrawable drawable = (BitmapDrawable) image.getDrawable();<br />        Bitmap bitmap = drawable.getBitmap();<br />        Bitmap scaledBitmap = Bitmap.createScaledBitmap(bitmap, bitmap.getWidth(),<br />                bitmap.getHeight(), true);<br /><br />        rows = cols = (int) Math.sqrt(chunkNumbers);<br />        chunkHeight = bitmap.getHeight() / rows;<br />        chunkWidth = bitmap.getWidth() / cols;<br /><br />        // xCoord and yCoord are the pixel positions of the image chunks<br />        int yCoord = 0;<br />        for (int x = 0; x &lt; rows; x++) {<br />            int xCoord = 0;<br />            for (int y = 0; y &lt; cols; y++) {<br />                chunkedImages.add(Bitmap.createBitmap(scaledBitmap, xCoord, yCoord, chunkWidth,<br />                        chunkHeight));<br />                xCoord += chunkWidth;<br />            }<br />            yCoord += chunkHeight;<br />        }<br />        return chunkedImages;<br />    }<br /><br />    /**<br />     * This method actually implements the code for merging the small images<br />     * @see android.view.View.OnClickListener#onClick(android.view.View)<br />     */<br />    @Override<br />    public void onClick(View view) {<br /><br />        // Get the width and height of the smaller chunks<br />        int chunkWidth = smallImages.get(0).getWidth();<br />        int chunkHeight = smallImages.get(0).getHeight();<br /><br />        // create a bitmap of a size which can hold the complete image after<br />        // merging<br />        Bitmap bitmap = Bitmap.createBitmap(chunkWidth * 5, chunkHeight * 5,<br />                Bitmap.Config.ARGB_4444);<br /><br />        // create a canvas for drawing all those small images<br />        Canvas canvas = new Canvas(bitmap);<br />        int count = 0;<br />        for (int rows = 0; rows &lt; 5; rows++) {<br />            for (int cols = 0; cols &lt; 5; cols++) {<br />                canvas.drawBitmap(smallImages.get(count), chunkWidth * cols, chunkHeight * rows,<br />                        null);<br />                count++;<br />            }<br />        }<br /><br />        // The result image is shown in a new Activity<br />        Intent intent = new Intent(SmallImagesActivity.this, MergedImage.class);<br />        intent.putExtra("merged_image", bitmap);<br />        startActivity(intent);<br />    }<br />}</pre><h3 style="text-align: left;">                   <span style="font-size: large;">Some Important points:</span></h3><div><span style="font-size: large;"><br /></span></div></div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Note that the actual code for merge operation is inside the onClick() method of the above code snippet. Below is the description about the variables of the onClick() method.<br /><div style="text-align: left;"></div><ol style="text-align: left;"><li>chunkHeight &amp; chunkWidth : Height and Width of smaller image chunks.</li><li>smallImages : An ArrayList&lt;Bitmap&gt; object which stores all the smaller image chunks in their bitmap format.</li><li>bitmap : The target bitmap which will represent the original image after merge.</li><li>canvas : The canvas object encapsulating the target bitmap to draw the smaller image chunks.</li></ol><div>You need to <b>FOCUS</b> more on the following line of code of <b>onClick()</b> method.</div><div><br /></div></div><pre>Bitmap bitmap = Bitmap.createBitmap(chunkWidth * 5, chunkHeight * 5, Bitmap.Config.ARGB_4444); </pre><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The 3rd argument of the <b>createBitmap()</b> method is the configuration for the Bitmap. I used <b>Bitmap.Config.ARGB_4444</b>. Documentation recommends <b>ARGB_8888</b> instead of <b>ARGB_4444</b>. As <b>ARGB_8888</b> will give you more qualitative image, so there is every chance of getting <b>BINDER TRANSACTION FAILED</b> error if your device configuration is low. So I used <b>ARGB_4444</b>, if you are not getting any error with <b>ARGB_8888</b>, ten better go for that. For more information about these configuration&nbsp;<a href="http://developer.android.com/reference/android/graphics/Bitmap.Config.html" rel="nofollow" target="_blank"><b>see this</b></a>.<br /><br /><h3 style="text-align: left;">              <span style="font-size: large;">Reference:</span></h3><div><span style="font-size: large;"><br /></span></div><div>You can download the complete source code from&nbsp;<a href="https://docs.google.com/open?id=0B0hpxZPa41T8U0xEeks0RjQtcW8" rel="nofollow" target="_blank"><span style="font-size: large;"><b>My Google Drive Account</b></span></a>.</div></div>If you want to achieve the same in Java using <a href="http://docs.oracle.com/javase/1.4.2/docs/api/javax/imageio/ImageIO.html" rel="nofollow" target="_blank"><span style="font-size: large;">ImageIO</span></a>, then you can <a href="http://kalanir.blogspot.in/2010/02/how-to-merge-multiple-images-into-one.html" rel="nofollow" target="_blank"><span style="font-size: large;">see this</span></a>.<br /><br /><h3 style="text-align: left;">             <span style="font-size: large;">Screen Shots:</span></h3><div><span style="font-size: large;"><br /></span></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; margin-right: 1em; text-align: left;"><tbody><tr><td style="text-align: center;"><img alt="Source Images" border="0" src="http://4.bp.blogspot.com/-ppv6-j1pc6I/T9LSEWj2k-I/AAAAAAAAATA/GEatCyrPSrQ/s320/Source+images.png" height="320" style="margin-left: auto; margin-right: auto;" title="Image Before Merge" width="212" /></td></tr><tr><td class="tr-caption" style="text-align: center;">Source Images</td></tr></tbody></table><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: right; margin-left: 1em; text-align: right;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-66q46NcqcN4/T9LSCpZzx9I/AAAAAAAAAS4/TxDSjC46Aso/s1600/Result+Image.png" imageanchor="1" style="clear: right; display: inline !important; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img alt="Result Image" border="0" src="http://1.bp.blogspot.com/-66q46NcqcN4/T9LSCpZzx9I/AAAAAAAAAS4/TxDSjC46Aso/s320/Result+Image.png" height="320" title="Image After Merge" width="212" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Result Image</td></tr></tbody></table><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-ppv6-j1pc6I/T9LSEWj2k-I/AAAAAAAAATA/GEatCyrPSrQ/s1600/Source+images.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"></a></div></div>